<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Parallel Bagging for FastKernelSurvivalSVM (Random Machines) — random_machines • FastSurvivalSVM</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Parallel Bagging for FastKernelSurvivalSVM (Random Machines) — random_machines"><meta property="og:description" content='Fits an ensemble of models using bootstrap aggregation (bagging) and
computes predictions for newdata. This function is also referred to
as "Random Machines" in the context of kernel survival machines.'><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FastSurvivalSVM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FastSurvivalSVM-wavelet-kernel.html">Using Custom Kernels with FastSurvivalSVM: The Wavelet Kernel</a>
    </li>
    <li>
      <a href="../articles/random_machines.html">Advanced Guide: Custom Kernels and Random Machines</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/prdm0/FastSurvivalSVM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Parallel Bagging for FastKernelSurvivalSVM (Random Machines)</h1>
    <small class="dont-index">Source: <a href="https://github.com/prdm0/FastSurvivalSVM/blob/HEAD/R/random_machines.R" class="external-link"><code>R/random_machines.R</code></a></small>
    <div class="hidden name"><code>random_machines.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits an ensemble of models using bootstrap aggregation (bagging) and
computes predictions for <code>newdata</code>. This function is also referred to
as "Random Machines" in the context of kernel survival machines.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">random_machines</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  time_col <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  delta_col <span class="op">=</span> <span class="st">"delta"</span>,</span>
<span>  <span class="va">kernels</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">100L</span>,</span>
<span>  mtry <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  crop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  beta_kernel <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta_bag <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prop_holdout <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  .progress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>data.frame</code> containing training data.</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>A <code>data.frame</code> containing test data for prediction.</p></dd>


<dt id="arg-time-col">time_col<a class="anchor" aria-label="anchor" href="#arg-time-col"></a></dt>
<dd><p>Name of the column with survival times.</p></dd>


<dt id="arg-delta-col">delta_col<a class="anchor" aria-label="anchor" href="#arg-delta-col"></a></dt>
<dd><p>Name of the column with the event indicator (1 = event, 0 = censored).</p></dd>


<dt id="arg-kernels">kernels<a class="anchor" aria-label="anchor" href="#arg-kernels"></a></dt>
<dd><p>A named list of kernel specifications. Each element must be a list
of arguments to the estimator (e.g., <code>kernel</code>, <code>alpha</code>,
<code>rank_ratio</code>, <code>fit_intercept</code>, <code>max_iter</code>, etc.).</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Integer. Number of bootstrap samples.</p></dd>


<dt id="arg-mtry">mtry<a class="anchor" aria-label="anchor" href="#arg-mtry"></a></dt>
<dd><p>Integer or Numeric. Number of variables to randomly sample at each split.</p><ul><li><p><code>NULL</code> (default): Use all variables.</p></li>
<li><p>Integer &gt;= 1: Select exactly <code>mtry</code> variables.</p></li>
<li><p>Numeric &lt; 1: Select <code>mtry</code> fraction of variables (e.g., 0.5 = 50%).</p></li>
</ul></dd>


<dt id="arg-crop">crop<a class="anchor" aria-label="anchor" href="#arg-crop"></a></dt>
<dd><p>Numeric or NULL. Threshold for kernel selection probabilities.
If provided (e.g., <code>0.10</code>), any kernel with a calculated weight
less than or equal to this value in the holdout phase will be
discarded (weight set to 0), and the remaining weights will be
rescaled to sum to 1.</p></dd>


<dt id="arg-beta-kernel">beta_kernel<a class="anchor" aria-label="anchor" href="#arg-beta-kernel"></a></dt>
<dd><p>Numeric. Temperature for kernel selection probabilities
(based on internal holdout C-index).</p></dd>


<dt id="arg-beta-bag">beta_bag<a class="anchor" aria-label="anchor" href="#arg-beta-bag"></a></dt>
<dd><p>Numeric. Temperature for ensemble weighting
(based on OOB C-index of each bootstrap model).</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>Integer. Number of parallel workers (via <code>mirai</code>).</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional integer passed to <code><a href="https://mirai.r-lib.org/reference/daemons.html" class="external-link">mirai::daemons</a></code> and used for
internal sampling.</p></dd>


<dt id="arg-prop-holdout">prop_holdout<a class="anchor" aria-label="anchor" href="#arg-prop-holdout"></a></dt>
<dd><p>Numeric in (0, 1). Proportion of the original training data
used as internal validation when computing the kernel selection weights.
For example, <code>prop_holdout = 0.20</code> means that 20% of the rows are
used as validation and the remaining 80% as training in the weighting phase.
If the dataset is too small for this split (either side &lt; 10 rows),
the function falls back to resubstitution.</p></dd>


<dt id="arg--progress">.progress<a class="anchor" aria-label="anchor" href="#arg--progress"></a></dt>
<dd><p>Logical. Show progress bar for the bootstrap loop?</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <code>"random_machines"</code> containing:</p><ul><li><p><code>preds</code>: Numeric vector of aggregated predictions for <code>newdata</code>.</p></li>
<li><p><code>weights</code>: Vector of weights assigned to each bootstrap model.</p></li>
<li><p><code>chosen_kernels</code>: Vector of kernel names selected in each bootstrap.</p></li>
<li><p><code>c_indices</code>: Vector of OOB C-indices for each bootstrap.</p></li>
<li><p><code>rank_ratio</code>: Rank ratio stored from the first successful model.</p></li>
<li><p><code>time_col</code>, <code>delta_col</code>: Names of the survival columns.</p></li>
<li><p><code>ensemble</code>: List with serialized models (Python pickle), features and params.</p></li>
<li><p><code>mtry</code>: The mtry value used.</p></li>
<li><p><code>kernel_lambdas</code>: The kernel selection probabilities (fixed from holdout).</p></li>
<li><p><code>kernel_names</code>: The names of the kernels used in bagging.</p></li>
<li><p><code>prop_holdout</code>: The proportion used for the internal holdout split.</p></li>
<li><p><code>crop</code>: The crop threshold used.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>Internal Holdout for Kernel Weights:</strong>
Instead of using training performance (resubstitution) to define the
selection probabilities of each kernel, this function splits the training
data into an internal training/validation set according to <code>prop_holdout</code>.
This mimics the behavior of the serial implementation where weights are
fixed based on a pre-bagging holdout.</p>
<p><strong>Architecture:</strong>
This function adopts a "Train-and-Predict" strategy:</p><ul><li><p>It accepts <code>newdata</code> and computes predictions inside the
        parallel workers (for each bootstrap model).</p></li>
<li><p>It stores a serialized version (Python pickle) of each
        fitted model to allow future predictions via
        <code><a href="predict.random_machines.html">predict.random_machines</a></code>.</p></li>
</ul><p><strong>Random Subspace (mtry):</strong>
The <code>mtry</code> parameter allows for random selection of a subset of
covariates in each base learner, similar to Random Forests.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_module_available.html" class="external-link">py_module_available</a></span><span class="op">(</span><span class="st">"sksurv"</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mirai"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/prdm0/FastSurvivalSVM" class="external-link">FastSurvivalSVM</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## 1. Data generation</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="data_generation.html">data_generation</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">300</span>, prop_cen <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## Train/Test split</span></span></span>
<span class="r-in"><span>  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">train_df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">test_df</span>  <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="va">idx</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## 2. Custom Kernel Factories ----------------------------------</span></span></span>
<span class="r-in"><span>  <span class="va">make_wavelet</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">A</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/force.html" class="external-link">force</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">u</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">A</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">1.75</span> <span class="op">*</span> <span class="va">u</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">u</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">make_poly</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">degree</span> <span class="op">=</span> <span class="fl">3</span>, <span class="va">coef0</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/force.html" class="external-link">force</a></span><span class="op">(</span><span class="va">degree</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/force.html" class="external-link">force</a></span><span class="op">(</span><span class="va">coef0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">z</span><span class="op">)</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">coef0</span><span class="op">)</span><span class="op">^</span><span class="va">degree</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## 3. Kernel Specifications (rank_ratio = 0 for Regression / Time)</span></span></span>
<span class="r-in"><span>  <span class="va">kernel_mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    linear   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      kernel        <span class="op">=</span> <span class="st">"linear"</span>,</span></span>
<span class="r-in"><span>      alpha         <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>      rank_ratio    <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>      fit_intercept <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    rbf      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      kernel        <span class="op">=</span> <span class="st">"rbf"</span>,</span></span>
<span class="r-in"><span>      alpha         <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>      gamma         <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>      rank_ratio    <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>      fit_intercept <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    poly_std <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      kernel        <span class="op">=</span> <span class="st">"poly"</span>,</span></span>
<span class="r-in"><span>      degree        <span class="op">=</span> <span class="fl">2L</span>,</span></span>
<span class="r-in"><span>      alpha         <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>      rank_ratio    <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>      fit_intercept <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    wavelet  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      kernel        <span class="op">=</span> <span class="fu">make_wavelet</span><span class="op">(</span>A <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      alpha         <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>      rank_ratio    <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>      fit_intercept <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    poly_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      kernel        <span class="op">=</span> <span class="fu">make_poly</span><span class="op">(</span>degree <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      alpha         <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>      rank_ratio    <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>      fit_intercept <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## 4. Run Random Machines with internal holdout for kernel weights</span></span></span>
<span class="r-in"><span>  <span class="va">rm_results</span> <span class="op">&lt;-</span> <span class="fu">random_machines</span><span class="op">(</span></span></span>
<span class="r-in"><span>    data         <span class="op">=</span> <span class="va">train_df</span>,</span></span>
<span class="r-in"><span>    newdata      <span class="op">=</span> <span class="va">test_df</span>,</span></span>
<span class="r-in"><span>    time_col     <span class="op">=</span> <span class="st">"tempo"</span>,</span></span>
<span class="r-in"><span>    delta_col    <span class="op">=</span> <span class="st">"cens"</span>,</span></span>
<span class="r-in"><span>    kernels      <span class="op">=</span> <span class="va">kernel_mix</span>,</span></span>
<span class="r-in"><span>    B            <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    mtry         <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>    beta_kernel  <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    beta_bag     <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    cores        <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    seed         <span class="op">=</span> <span class="fl">42</span>,</span></span>
<span class="r-in"><span>    prop_holdout <span class="op">=</span> <span class="fl">0.20</span>,</span></span>
<span class="r-in"><span>    crop         <span class="op">=</span> <span class="fl">0.15</span>,  <span class="co"># Eliminate kernels with weight &lt;= 0.15</span></span></span>
<span class="r-in"><span>    .progress    <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rm_results</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## 5. Score on independent test set using S3 method</span></span></span>
<span class="r-in"><span>  <span class="va">cidx_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="score.html">score</a></span><span class="op">(</span><span class="va">rm_results</span>, <span class="va">test_df</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Test C-index (Random Machines): %.4f\n"</span>, <span class="va">cidx_test</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Pedro Rafael Diniz Marinho, Agatha Sacramento Rodrigues.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

